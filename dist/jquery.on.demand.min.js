(function(e){var c={fn2script:function(a){return a+"-ondemand.js"},jqueryPlugin:!1},g,b,h,j,d;g=function(a){this.options=e.extend({},c,a);this._defaults=c;this._name="onDemand";this._version="0.1";this._proxy={};d=this};b=g.prototype;b.fn2script=function(a){return this.options.fn2script(a)};b.firstLoad=function(a,f,b){var c=this.fn2script(a),i=e.Deferred(),g;if(h(d._proxy[a]))g=d._proxy[a].apply(b,f),i.resolve(g);else{if(!c)return;e.getScript(c).done(function(){var c;h(d._proxy[a])?c=d._proxy[a].apply(b,
f):j(d._proxy[a])?c=d._proxy[a]:d.options.jqueryPlugin&&(c=e.fn[a].apply(b,f));i.resolve(c)}).fail(function(){i.reject("OnDemand failed to load script "+c)})}return i.promise()};b.internalPreload=function(a){var f=this.fn2script(a);h(d._proxy[a])||f&&e.getScript(f)};b.setOptions=function(a){this.options=e.extend({},c,a)};b.resetOptions=function(){this.options=e.extend({},c,{})};b.preload=function(a){this.internalPreload(a)};b.invoke=function(a,f,b){return this.firstLoad(a,f,b)};b.use=function(a){return this.firstLoad(a)};
b.register=function(a,b){if(h(b)||j(b))d._proxy[a]=b};b.registerAll=function(a){for(var b in a)a.hasOwnProperty(b)&&this.register(b,a[b])};h=function(a){return"function"===typeof a};j=function(a){return"object"===typeof a};e.onDemand=new g(void 0)})(jQuery,window);
